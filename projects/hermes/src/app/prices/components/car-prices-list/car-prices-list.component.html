<div class="table-container">
  <table *ngIf="dataSource; else notFoundTemplate"
    mat-table
    [dataSource]="dataSource"
    class="mat-elevation-z1">

    <ng-container matColumnDef="model">
      <th mat-header-cell
        *matHeaderCellDef>Model</th>
      <td mat-cell
        *matCellDef="let element"> {{element.model}} </td>
    </ng-container>

    <ng-container matColumnDef="brand">
      <th mat-header-cell
        *matHeaderCellDef>
        <span>Hãng</span>
        <mat-select [(value)]="filterValue"
          (selectionChange)="applyFilter()">
          <mat-option [value]="">-</mat-option>
          <mat-option *ngFor="let option of options.brand"
            [value]="option">{{ option }}</mat-option>
        </mat-select>
      </th>
      <td mat-cell
        *matCellDef="let element"> {{element.brand}} </td>
    </ng-container>

    <ng-container matColumnDef="type">
      <th mat-header-cell
        *matHeaderCellDef>
        <span>Loại xe</span>
        <mat-select [(value)]="filterValue"
          (selectionChange)="applyFilter()">
          <mat-option [value]="">-</mat-option>
          <mat-option *ngFor="let option of options.type"
            [value]="option">{{ option }}</mat-option>
        </mat-select>
      </th>
      <td mat-cell
        *matCellDef="let element"> {{element.type}} </td>
    </ng-container>

    <ng-container matColumnDef="origin">
      <th mat-header-cell
        *matHeaderCellDef>
        <span>Nguồn gốc</span>
        <mat-select [(value)]="filterValue"
          (selectionChange)="applyFilter()">
          <mat-option [value]="">-</mat-option>
          <mat-option *ngFor="let option of options.origin"
            [value]="option">{{ option }}</mat-option>
        </mat-select>
      </th>
      <td mat-cell
        *matCellDef="let element"> {{element.origin}} </td>
    </ng-container>

    <ng-container matColumnDef="engine">
      <th mat-header-cell
        *matHeaderCellDef> Động cơ </th>
      <td mat-cell
        *matCellDef="let element"> {{element.engine}} </td>
    </ng-container>

    <ng-container matColumnDef="listPrice">
      <th mat-header-cell
        *matHeaderCellDef> Giá niêm yết (tr) </th>
      <td mat-cell
        *matCellDef="let element"> {{element.listPrice | number}} </td>
    </ng-container>

    <ng-container matColumnDef="salePrice">
      <th mat-header-cell
        *matHeaderCellDef> Giá đàm phán (tr) </th>
      <td mat-cell
        *matCellDef="let element"> {{element.salePrice | number}} </td>
    </ng-container>

    <ng-container matColumnDef="publishAt">
      <th mat-header-cell
        *matHeaderCellDef> Đăng lúc </th>
      <td mat-cell
        *matCellDef="let element"> {{element.publishAt | date: "MM/yyyy"}} </td>
    </ng-container>

    <tr mat-header-row
      *matHeaderRowDef="displayedColumns; sticky: true"></tr>
    <tr mat-row
      *matRowDef="let element; columns: displayedColumns"
      class="element-row"
      (click)="selectField(element)"></tr>

  </table>
  <button mat-fab
    class="fab-button"
    (click)="selectField(null)">
    <mat-icon aria-label="icon-button with a plus icon">add</mat-icon>
  </button>
</div>

<ng-template #notFoundTemplate>
  <div class="center">
    <mat-progress-spinner class="mini-spinner"
      color="accent"
      mode="indeterminate"
      strokeWidth="2"
      diameter="25">
    </mat-progress-spinner>
    <p>Đang tải dữ liệu...</p>
    <button mat-raised-button
      (click)="fetchData()">Nhấn vào đây để tải lại</button>
  </div>
</ng-template>